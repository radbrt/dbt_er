version: 2

models:
  - name: wrk_foretak_010
    description: Foretak fra enhetsregisteret
    columns:
      - name: orgnr
        description: Company ID
      - name: navn
        description: Company name
      - name: nace_1
        description: Industry code
      - name: antall_ansatte
        description: Number of employees

    tests:
      - dbt_constraints.primary_key:
          column_name: orgnr
      - dbt_constraints.foreign_key:
          fk_column_name: nace_1
          pk_table_name: ref('wrk_nace')
          pk_column_name: naerk
          config:
            severity: warn
            always_create_constraint: true
            
  - name: wrk_nace
    description: NACE-koder fra enhetsregisteret
    columns:
      - name: naerk
        description: NACE-kode
        tests:
          - unique
          - not_null

      - name: naerk_tekst
        description: NACE-kode tekst
